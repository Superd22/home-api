{"ast":null,"code":"import { HttpClientModule } from '@angular/common/http';\nimport { APP_INITIALIZER } from '@angular/core';\nimport { AuthConfig, OAuthModule, OAuthModuleConfig, OAuthStorage } from 'angular-oauth2-oidc';\nimport { authAppInitializerFactory } from './auth-app-initializer.factory.ts';\nimport { authConfig } from './auth-config';\nimport { AuthGuardWithForcedLogin } from './auth-guard';\nimport { authModuleConfig } from './auth-module-config';\nimport { AuthService } from './auth.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"angular-oauth2-oidc\";\n// We need a factory since localStorage is not available at AOT build time\nexport function storageFactory() {\n  return localStorage;\n}\nexport class CoreModule {\n  constructor(parentModule) {\n    if (parentModule) {\n      throw new Error('CoreModule is already loaded. Import it in the AppModule only');\n    }\n  }\n  static forRoot() {\n    return {\n      ngModule: CoreModule,\n      providers: [{\n        provide: APP_INITIALIZER,\n        useFactory: authAppInitializerFactory,\n        deps: [AuthService],\n        multi: true\n      }, {\n        provide: AuthConfig,\n        useValue: authConfig\n      }, {\n        provide: OAuthModuleConfig,\n        useValue: authModuleConfig\n      }, {\n        provide: OAuthStorage,\n        useFactory: storageFactory\n      }]\n    };\n  }\n  static #_ = this.ɵfac = function CoreModule_Factory(t) {\n    return new (t || CoreModule)(i0.ɵɵinject(CoreModule, 12));\n  };\n  static #_2 = this.ɵmod = /*@__PURE__*/i0.ɵɵdefineNgModule({\n    type: CoreModule\n  });\n  static #_3 = this.ɵinj = /*@__PURE__*/i0.ɵɵdefineInjector({\n    providers: [AuthService, AuthGuardWithForcedLogin],\n    imports: [HttpClientModule, OAuthModule.forRoot()]\n  });\n}\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && i0.ɵɵsetNgModuleScope(CoreModule, {\n    imports: [HttpClientModule, i1.OAuthModule]\n  });\n})();","map":{"version":3,"mappings":"AAAA,SAASA,gBAAgB,QAAQ,sBAAsB;AACvD,SAASC,eAAe,QAA2D,eAAe;AAClG,SAASC,UAAU,EAAEC,WAAW,EAAEC,iBAAiB,EAAEC,YAAY,QAAQ,qBAAqB;AAC9F,SAASC,yBAAyB,QAAQ,mCAAmC;AAC7E,SAASC,UAAU,QAAQ,eAAe;AAC1C,SAASC,wBAAwB,QAAQ,cAAc;AACvD,SAASC,gBAAgB,QAAQ,sBAAsB;AACvD,SAASC,WAAW,QAAQ,gBAAgB;;;AAE5C;AACA,OAAM,SAAUC,cAAc;EAC5B,OAAOC,YAAY;AACrB;AAYA,OAAM,MAAOC,UAAU;EAarBC,YAAoCC,YAAwB;IAC1D,IAAIA,YAAY,EAAE;MAChB,MAAM,IAAIC,KAAK,CAAC,+DAA+D,CAAC;;EAEpF;EAhBA,OAAOC,OAAO;IACZ,OAAO;MACLC,QAAQ,EAAEL,UAAU;MACpBM,SAAS,EAAE,CACT;QAAEC,OAAO,EAAEnB,eAAe;QAAEoB,UAAU,EAAEf,yBAAyB;QAAEgB,IAAI,EAAE,CAACZ,WAAW,CAAC;QAAEa,KAAK,EAAE;MAAI,CAAE,EACrG;QAAEH,OAAO,EAAElB,UAAU;QAAEsB,QAAQ,EAAEjB;MAAU,CAAE,EAC7C;QAAEa,OAAO,EAAEhB,iBAAiB;QAAEoB,QAAQ,EAAEf;MAAgB,CAAE,EAC1D;QAAEW,OAAO,EAAEf,YAAY;QAAEgB,UAAU,EAAEV;MAAc,CAAE;KAExD;EACH;EAAC;qBAXUE,UAAU;EAAA;EAAA;UAAVA;EAAU;EAAA;eALV,CACTH,WAAW,EACXF,wBAAwB,CACzB;IAAAiB,UANCzB,gBAAgB,EAChBG,WAAW,CAACc,OAAO,EAAE;EAAA;;;2EAOZJ,UAAU;IAAAY,UARnBzB,gBAAgB;EAAA;AAAA","names":["HttpClientModule","APP_INITIALIZER","AuthConfig","OAuthModule","OAuthModuleConfig","OAuthStorage","authAppInitializerFactory","authConfig","AuthGuardWithForcedLogin","authModuleConfig","AuthService","storageFactory","localStorage","CoreModule","constructor","parentModule","Error","forRoot","ngModule","providers","provide","useFactory","deps","multi","useValue","imports"],"sourceRoot":"","sources":["/home/david/perso/home-api/apps/server-manager/front/app/core/core.module.ts"],"sourcesContent":["import { HttpClientModule } from '@angular/common/http';\nimport { APP_INITIALIZER, ModuleWithProviders, NgModule, Optional, SkipSelf } from '@angular/core';\nimport { AuthConfig, OAuthModule, OAuthModuleConfig, OAuthStorage } from 'angular-oauth2-oidc';\nimport { authAppInitializerFactory } from './auth-app-initializer.factory.ts';\nimport { authConfig } from './auth-config';\nimport { AuthGuardWithForcedLogin } from './auth-guard';\nimport { authModuleConfig } from './auth-module-config';\nimport { AuthService } from './auth.service';\n\n// We need a factory since localStorage is not available at AOT build time\nexport function storageFactory(): OAuthStorage {\n  return localStorage;\n}\n\n@NgModule({\n  imports: [\n    HttpClientModule,\n    OAuthModule.forRoot(),\n  ],\n  providers: [\n    AuthService,\n    AuthGuardWithForcedLogin,\n  ],\n})\nexport class CoreModule {\n  static forRoot(): ModuleWithProviders<CoreModule> {\n    return {\n      ngModule: CoreModule,\n      providers: [\n        { provide: APP_INITIALIZER, useFactory: authAppInitializerFactory, deps: [AuthService], multi: true },\n        { provide: AuthConfig, useValue: authConfig },\n        { provide: OAuthModuleConfig, useValue: authModuleConfig },\n        { provide: OAuthStorage, useFactory: storageFactory },\n      ]\n    };\n  }\n\n  constructor(@Optional() @SkipSelf() parentModule: CoreModule) {\n    if (parentModule) {\n      throw new Error('CoreModule is already loaded. Import it in the AppModule only');\n    }\n  }\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}